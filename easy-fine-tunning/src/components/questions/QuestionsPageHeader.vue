<template>
  <div class="questions-page-header">
    <h2>{{ $t('questions.title') }} ({{ questionsTotal }})</h2>
    <div class="header-actions">
      <el-button
        type="danger"
        :icon="Delete"
        :disabled="selectedQuestionsCount === 0"
        @click="$emit('batch-delete')"
      >
        {{ $t('questions.deleteSelected') }}
      </el-button>

      <el-dropdown @command="handleCreateCommand">
        <el-button type="primary" :icon="Plus">
          {{ $t('questions.createQuestion') }}
          <el-icon class="el-icon--right"><arrow-down /></el-icon>
        </el-button>
        <template #dropdown>
          <el-dropdown-menu>
            <el-dropdown-item command="question">
              {{ $t('questions.createNormalQuestion') }}
            </el-dropdown-item>
            <el-dropdown-item command="template">
              {{ $t('questions.createQuestionTemplate') }}
            </el-dropdown-item>
          </el-dropdown-menu>
        </template>
      </el-dropdown>

      <el-tooltip :content="$t('questions.autoGenerateDatasetTip') || '创建后台批量处理任务：自动查询待生成答案的问题并生成数据集'">
        <el-dropdown @command="handleGenerateCommand">
          <el-button type="success" :icon="MagicStick">
            {{ $t('questions.autoGenerateDataset') }}
            <el-icon class="el-icon--right"><arrow-down /></el-icon>
          </el-button>
          <template #dropdown>
            <el-dropdown-menu>
              <el-dropdown-item command="single-turn">
                <el-icon><Document /></el-icon>
                {{ $t('questions.generateSingleTurnDataset') }}
              </el-dropdown-item>
              <el-dropdown-item command="multi-turn">
                <el-icon><ChatLineRound /></el-icon>
                {{ $t('questions.generateMultiTurnDataset') }}
              </el-dropdown-item>
              <el-dropdown-item command="image">
                <el-icon><Picture /></el-icon>
                {{ $t('questions.generateImageDataset') }}
              </el-dropdown-item>
            </el-dropdown-menu>
          </template>
        </el-dropdown>
      </el-tooltip>
    </div>
  </div>
</template>

<script setup>
import { Delete, Plus, MagicStick, ArrowDown, Document, ChatLineRound, Picture } from '@element-plus/icons-vue';

const props = defineProps({
  questionsTotal: {
    type: Number,
    default: 0
  },
  selectedQuestionsCount: {
    type: Number,
    default: 0
  }
});

const emit = defineEmits([
  'batch-delete',
  'create-question',
  'create-template',
  'batch-generate',
  'auto-generate-datasets',
  'auto-generate-multi-turn',
  'auto-generate-image'
]);

const handleCreateCommand = (command) => {
  if (command === 'question') {
    emit('create-question');
  } else if (command === 'template') {
    emit('create-template');
  }
};

const handleGenerateCommand = (command) => {
  if (command === 'single-turn') {
    emit('auto-generate-datasets');
  } else if (command === 'multi-turn') {
    emit('auto-generate-multi-turn');
  } else if (command === 'image') {
    emit('auto-generate-image');
  }
};
</script>

<style scoped>
.questions-page-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 24px;
}

.header-actions {
  display: flex;
  gap: 12px;
}
</style>

