import{cp as te,dB as ae,cq as h,d3 as B,ct as le,cu as s,cU as ne,cx as d,cy as p,cB as c,cz as e,cA as n,cC as oe,cD as se,cF as ce,cH as _,dK as re,cK as y,dU as ie,eP as de,cv as ue,cJ as g,en as pe,eQ as _e,eR as ge,dM as fe,dX as f,dY as me,cR as ve}from"./index-07dfdb25.js";import{P as he,p as x}from"./ProductDialog-cf1080a9.js";const ye={class:"product-lib-container"},be={class:"product-lib-header"},xe={class:"search-section"},Ce={class:"search-filters"},ke={class:"action-group"},we={class:"product-lib-content"},ze={class:"product-name-cell"},De=["onClick"],Me={class:"price"},Pe={class:"interest-rate-cell"},Ve={key:0,class:"rate-value"},Se={key:1,class:"no-data"},Be={key:0},Re={key:1,class:"no-data"},Te={class:"pagination-container"},Ue=te({__name:"index",setup($e){const R=ae(),C=h(!1),M=h([]),T=h([]),k=h(),U=h(),i=B({name:"",category:"",status:""}),o=B({current_page:1,page_size:20,total:0}),$=h([{label:"个人贷款",value:"个人贷款"},{label:"企业贷款",value:"企业贷款"},{label:"信用卡",value:"信用卡"},{label:"理财产品",value:"理财产品"},{label:"保险产品",value:"保险产品"}]),F=t=>{if(!t)return"-";try{return new Date(t).toLocaleDateString("zh-CN")}catch{return t}},u=async()=>{C.value=!0;try{const{data:t}=await x.getProducts({current_page:o.current_page,page_size:o.page_size},i);M.value=t.records||[],o.total=t.total||0}catch(t){console.error("获取产品列表失败:",t),f.error("获取产品列表失败")}finally{C.value=!1}},w=()=>{o.current_page=1,u()},L=t=>{o.page_size=t,o.current_page=1,u()},N=t=>{o.current_page=t,u()},E=t=>{T.value=t},A=()=>{k.value.open()},H=t=>{k.value.open(t)},P=t=>{R.push(`/product-lib/${t.id}/detail`)},I=async t=>{try{await me.confirm(`确定要删除产品"${t.name}"吗？`,"删除确认",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),await x.delProduct(t.id),f.success("删除成功"),u()}catch(l){l!=="cancel"&&(console.error("删除产品失败:",l),f.error("删除产品失败"))}},K=async()=>{try{await x.exportProducts(i),f.success("导出成功")}catch(t){console.error("导出失败:",t),f.error("导出失败")}},j=async t=>{const l=new FormData;l.append("file",t.raw);try{await x.importProducts(l),f.success("导入成功"),u()}catch(z){console.error("导入失败:",z),f.error("导入失败")}},q=()=>{u()},J=t=>({active:"success",inactive:"danger",draft:"warning"})[t]||"",O=t=>({active:"活跃",inactive:"停用",draft:"草稿"})[t]||t,Q=t=>({low:"success",medium:"warning",high:"danger"})[t]||"",X=t=>({low:"低风险",medium:"中风险",high:"高风险"})[t]||t;return le(()=>{u()}),(t,l)=>{const z=s("el-input"),b=s("el-option"),V=s("el-select"),m=s("el-icon"),v=s("el-button"),Y=s("el-upload"),r=s("el-table-column"),S=s("el-tag"),G=s("el-button-group"),W=s("el-table"),Z=s("el-pagination"),ee=ne("loading");return d(),p("div",ye,[c("div",be,[l[8]||(l[8]=c("div",{class:"title-section"},[c("h2",{class:"page-title"},"产品库")],-1)),c("div",xe,[c("div",Ce,[e(z,{modelValue:i.name,"onUpdate:modelValue":l[0]||(l[0]=a=>i.name=a),onChange:w,placeholder:"搜索产品名称","prefix-icon":"Search",class:"search-input",clearable:""},null,8,["modelValue"]),e(V,{modelValue:i.category,"onUpdate:modelValue":l[1]||(l[1]=a=>i.category=a),class:"filter-item",onChange:w,placeholder:"选择分类",clearable:""},{default:n(()=>[(d(!0),p(oe,null,se($.value,a=>(d(),ce(b,{key:a.value,label:a.label,value:a.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"]),e(V,{modelValue:i.status,"onUpdate:modelValue":l[2]||(l[2]=a=>i.status=a),class:"filter-item",onChange:w,placeholder:"状态",clearable:""},{default:n(()=>[e(b,{label:"活跃",value:"active"}),e(b,{label:"停用",value:"inactive"}),e(b,{label:"草稿",value:"draft"})]),_:1},8,["modelValue"]),c("div",ke,[e(v,{type:"primary",onClick:A},{default:n(()=>[e(m,null,{default:n(()=>[e(_(re))]),_:1}),l[5]||(l[5]=y(" 新增产品 "))]),_:1,__:[5]}),e(v,{onClick:K,plain:""},{default:n(()=>[e(m,null,{default:n(()=>[e(_(ie))]),_:1}),l[6]||(l[6]=y(" 导出数据 "))]),_:1,__:[6]}),e(Y,{ref_key:"uploadRef",ref:U,"show-file-list":!1,"on-change":j,"auto-upload":!1,accept:".xlsx,.xls"},{default:n(()=>[e(v,{plain:""},{default:n(()=>[e(m,null,{default:n(()=>[e(_(de))]),_:1}),l[7]||(l[7]=y(" 导入数据 "))]),_:1,__:[7]})]),_:1},512)])])])]),ue((d(),p("div",we,[e(W,{data:M.value,style:{width:"100%"},onSelectionChange:E,border:""},{default:n(()=>[e(r,{type:"selection",width:"45",align:"center"}),e(r,{prop:"name",label:"产品名称","min-width":"280"},{default:n(({row:a})=>[c("div",ze,[e(S,{type:J(a.status),size:"small",effect:"plain",class:"status-tag"},{default:n(()=>[y(g(O(a.status)),1)]),_:2},1032,["type"]),c("span",{class:"product-name",onClick:D=>P(a)},g(a.name),9,De)])]),_:1}),e(r,{prop:"category",label:"分类",width:"120",align:"center"}),e(r,{prop:"price",label:"价格",width:"120",align:"right"},{default:n(({row:a})=>[c("span",Me,"￥"+g(_(pe)(a.price)),1)]),_:1}),e(r,{prop:"interest_rate",label:"利率",width:"120",align:"center"},{default:n(({row:a})=>[c("div",Pe,[a.interest_rate?(d(),p("span",Ve,g(a.interest_rate)+"%",1)):(d(),p("span",Se,"-"))])]),_:1}),e(r,{prop:"term_months",label:"期限(月)",width:"100",align:"center"},{default:n(({row:a})=>[a.term_months?(d(),p("span",Be,g(a.term_months),1)):(d(),p("span",Re,"-"))]),_:1}),e(r,{prop:"risk_level",label:"风险等级",width:"100",align:"center"},{default:n(({row:a})=>[e(S,{type:Q(a.risk_level),size:"small",effect:"plain"},{default:n(()=>[y(g(X(a.risk_level)),1)]),_:2},1032,["type"])]),_:1}),e(r,{prop:"created_time",label:"创建时间",width:"160",align:"center"},{default:n(({row:a})=>[y(g(F(a.created_time)),1)]),_:1}),e(r,{label:"操作",width:"180",fixed:"right",align:"center"},{default:n(({row:a})=>[e(G,null,{default:n(()=>[e(v,{size:"small",onClick:D=>P(a),type:"primary",text:""},{default:n(()=>[e(m,null,{default:n(()=>[e(_(_e))]),_:1})]),_:2},1032,["onClick"]),e(v,{size:"small",onClick:D=>H(a),type:"primary",text:""},{default:n(()=>[e(m,null,{default:n(()=>[e(_(ge))]),_:1})]),_:2},1032,["onClick"]),e(v,{size:"small",onClick:D=>I(a),type:"danger",text:""},{default:n(()=>[e(m,null,{default:n(()=>[e(_(fe))]),_:1})]),_:2},1032,["onClick"])]),_:2},1024)]),_:1})]),_:1},8,["data"]),c("div",Te,[e(Z,{"current-page":o.current_page,"onUpdate:currentPage":l[3]||(l[3]=a=>o.current_page=a),"page-size":o.page_size,"onUpdate:pageSize":l[4]||(l[4]=a=>o.page_size=a),"page-sizes":[10,20,50,100],total:o.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:L,onCurrentChange:N},null,8,["current-page","page-size","total"])])])),[[ee,C.value]]),e(he,{ref_key:"productDialogRef",ref:k,onSuccess:q},null,512)])}}});const Ne=ve(Ue,[["__scopeId","data-v-4126e5cd"]]);export{Ne as default};
