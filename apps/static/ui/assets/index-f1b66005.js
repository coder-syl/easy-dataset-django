import{cp as te,cq as _,d3 as B,cr as le,ct as ae,cu as n,cU as se,cx as V,cy as D,cB as z,cJ as d,cz as t,cA as a,cH as y,dK as oe,cK as r,f5 as F,dg as ie,dQ as ne,cv as de,cF as re,eR as ce,dM as ue,f6 as S,dX as w,dY as pe,cR as fe}from"./index-07dfdb25.js";const me={class:"system-config"},ve={class:"header"},ge={class:"search-bar"},_e={key:0},ye={key:1},be={class:"pagination"},he=te({__name:"index",setup(we){const $=_(!1),b=_(!1),v=_(!1),u=_(!1),h=_(),c=B({search:"",is_active:""}),i=B({page:1,page_size:10,total:0}),P=_([]),o=B({id:null,key:"",value:"",description:"",is_active:!0}),K={key:[{required:!0,message:"请输入配置键",trigger:"blur"},{pattern:/^[a-zA-Z0-9_-]+$/,message:"配置键只能包含字母、数字、下划线和连字符",trigger:"blur"}],value:[{required:!0,message:"请输入配置值",trigger:"blur"}]},L=le(()=>u.value?"编辑配置":"新增配置"),A=e=>e?new Date(e).toLocaleString("zh-CN"):"",p=async()=>{$.value=!0;try{const e={page:i.page,page_size:i.page_size,search:c.search,is_active:c.is_active},s=await S.getSystemConfigs(e,$);s.code===200&&(P.value=s.data.list,i.total=s.data.total)}catch{w.error("获取配置列表失败")}finally{$.value=!1}},E=()=>{i.page=1,p()},M=()=>{c.search="",c.is_active="",i.page=1,p()},N=e=>{i.page_size=e,i.page=1,p()},T=e=>{i.page=e,p()},q=()=>{u.value=!1,R(),v.value=!0},j=e=>{u.value=!0,Object.assign(o,e),v.value=!0},H=async e=>{try{await pe.confirm("确定要删除这个配置吗？","确认删除",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}),(await S.deleteSystemConfig(e.id)).code===200&&(w.success("删除成功"),p())}catch(s){s!=="cancel"&&w.error("删除失败")}},I=async()=>{if(h.value)try{await h.value.validate(),b.value=!0;let e;u.value&&o.id?e=await S.updateSystemConfig(o.id,o,b):e=await S.createSystemConfig(o,b),e.code===200&&(w.success(u.value?"更新成功":"创建成功"),v.value=!1,p())}catch{w.error(u.value?"更新失败":"创建失败")}finally{b.value=!1}},R=()=>{o.id=null,o.key="",o.value="",o.description="",o.is_active=!0},J=()=>{R(),h.value&&h.value.resetFields()};return ae(()=>{p()}),(e,s)=>{const g=n("el-icon"),f=n("el-button"),C=n("el-input"),U=n("el-option"),O=n("el-select"),m=n("el-table-column"),Q=n("el-tag"),X=n("el-table"),Y=n("el-pagination"),k=n("el-form-item"),Z=n("el-switch"),G=n("el-form"),W=n("el-dialog"),x=se("loading");return V(),D("div",me,[z("div",ve,[z("h2",null,d(e.$t("views.system.config.title")),1),t(f,{type:"primary",onClick:q},{default:a(()=>[t(g,null,{default:a(()=>[t(y(oe))]),_:1}),r(" "+d(e.$t("views.system.config.add")),1)]),_:1})]),z("div",ge,[t(C,{modelValue:c.search,"onUpdate:modelValue":s[0]||(s[0]=l=>c.search=l),placeholder:e.$t("views.system.config.searchPlaceholder"),style:{width:"300px"},clearable:"",onKeyup:ie(E,["enter"])},{prefix:a(()=>[t(g,null,{default:a(()=>[t(y(F))]),_:1})]),_:1},8,["modelValue","placeholder"]),t(O,{modelValue:c.is_active,"onUpdate:modelValue":s[1]||(s[1]=l=>c.is_active=l),placeholder:e.$t("views.system.config.statusPlaceholder"),style:{width:"150px"},clearable:""},{default:a(()=>[t(U,{label:e.$t("views.system.config.all"),value:""},null,8,["label"]),t(U,{label:e.$t("views.system.config.enabled"),value:"true"},null,8,["label"]),t(U,{label:e.$t("views.system.config.disabled"),value:"false"},null,8,["label"])]),_:1},8,["modelValue","placeholder"]),t(f,{type:"primary",onClick:E},{default:a(()=>[t(g,null,{default:a(()=>[t(y(F))]),_:1}),r(" "+d(e.$t("views.system.config.search")),1)]),_:1}),t(f,{onClick:M},{default:a(()=>[t(g,null,{default:a(()=>[t(y(ne))]),_:1}),r(" "+d(e.$t("views.system.config.reset")),1)]),_:1})]),de((V(),re(X,{data:P.value,style:{width:"100%"},border:""},{default:a(()=>[t(m,{prop:"key",label:e.$t("views.system.config.key"),"min-width":"200"},null,8,["label"]),t(m,{prop:"value",label:e.$t("views.system.config.value"),"min-width":"300"},{default:a(({row:l})=>[l.value&&l.value.length>50?(V(),D("span",_e,d(l.value.substring(0,50))+"... ",1)):(V(),D("span",ye,d(l.value),1))]),_:1},8,["label"]),t(m,{prop:"description",label:e.$t("views.system.config.description"),"min-width":"200"},null,8,["label"]),t(m,{prop:"is_active",label:e.$t("views.system.config.status"),width:"100"},{default:a(({row:l})=>[t(Q,{type:l.is_active?"success":"danger"},{default:a(()=>[r(d(l.is_active?e.$t("views.system.config.enabled"):e.$t("views.system.config.disabled")),1)]),_:2},1032,["type"])]),_:1},8,["label"]),t(m,{prop:"created_at",label:e.$t("views.system.config.createdAt"),width:"180"},{default:a(({row:l})=>[r(d(A(l.created_at)),1)]),_:1},8,["label"]),t(m,{prop:"updated_at",label:e.$t("views.system.config.updatedAt"),width:"180"},{default:a(({row:l})=>[r(d(A(l.updated_at)),1)]),_:1},8,["label"]),t(m,{label:e.$t("views.system.config.actions"),width:"200",fixed:"right"},{default:a(({row:l})=>[t(f,{size:"small",onClick:ee=>j(l)},{default:a(()=>[t(g,null,{default:a(()=>[t(y(ce))]),_:1}),r(" "+d(e.$t("views.system.config.edit")),1)]),_:2},1032,["onClick"]),t(f,{size:"small",type:"danger",onClick:ee=>H(l)},{default:a(()=>[t(g,null,{default:a(()=>[t(y(ue))]),_:1}),r(" "+d(e.$t("views.system.config.delete")),1)]),_:2},1032,["onClick"])]),_:1},8,["label"])]),_:1},8,["data"])),[[x,$.value]]),z("div",be,[t(Y,{"current-page":i.page,"onUpdate:currentPage":s[2]||(s[2]=l=>i.page=l),"page-size":i.page_size,"onUpdate:pageSize":s[3]||(s[3]=l=>i.page_size=l),"page-sizes":[10,20,50,100],total:i.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:N,onCurrentChange:T},null,8,["current-page","page-size","total"])]),t(W,{modelValue:v.value,"onUpdate:modelValue":s[9]||(s[9]=l=>v.value=l),title:L.value,width:"600px",onClose:J},{footer:a(()=>[t(f,{onClick:s[8]||(s[8]=l=>v.value=!1)},{default:a(()=>[r(d(e.$t("views.system.config.cancel")),1)]),_:1}),t(f,{type:"primary",onClick:I,loading:b.value},{default:a(()=>[r(d(e.$t("views.system.config.confirm")),1)]),_:1},8,["loading"])]),default:a(()=>[t(G,{ref_key:"formRef",ref:h,model:o,rules:K,"label-width":"120px"},{default:a(()=>[t(k,{label:e.$t("views.system.config.key"),prop:"key"},{default:a(()=>[t(C,{modelValue:o.key,"onUpdate:modelValue":s[4]||(s[4]=l=>o.key=l),placeholder:e.$t("views.system.config.keyPlaceholder"),disabled:u.value},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),t(k,{label:e.$t("views.system.config.value"),prop:"value"},{default:a(()=>[t(C,{modelValue:o.value,"onUpdate:modelValue":s[5]||(s[5]=l=>o.value=l),type:"textarea",rows:4,placeholder:e.$t("views.system.config.valuePlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(k,{label:e.$t("views.system.config.description"),prop:"description"},{default:a(()=>[t(C,{modelValue:o.description,"onUpdate:modelValue":s[6]||(s[6]=l=>o.description=l),type:"textarea",rows:3,placeholder:e.$t("views.system.config.descriptionPlaceholder")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),t(k,{label:e.$t("views.system.config.status"),prop:"is_active"},{default:a(()=>[t(Z,{modelValue:o.is_active,"onUpdate:modelValue":s[7]||(s[7]=l=>o.is_active=l),"active-text":e.$t("views.system.config.enabled"),"inactive-text":e.$t("views.system.config.disabled")},null,8,["modelValue","active-text","inactive-text"])]),_:1},8,["label"])]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});const Ce=fe(he,[["__scopeId","data-v-d4b0a998"]]);export{Ce as default};
